# everympbot

This is a Python script to assemble tweets for the @everympbot account on Twitter. It pulls data from Wikidata to generate a short summary for a given MP.

**Version 0**

This generates a short summary by randomly selecting an MP from a list of candidates (in `sourceids.txt`). Candidates are [prefiltered](https://query.wikidata.org/#%23%20query%20to%20find%20ONLY%20simple%20cases%20where%20the%20MP%20did%20not%20change%20seat%20or%20party%3B%20seatLabel%20is%20used%20to%20catch%20renames.%0A%23%20there%20are%20about%203900%20of%20them%20as%20of%2030%2F12%2F20%20after%20sitting%20MPs%20are%20removed%20%284000%20with%20sitting%20MPs%20left%20in%29%0A%0Aselect%20distinct%20%3Fmp%20%3FmpLabel%20%3Fterms%20%3Fterms_with_parties%20%3Fterms_with_seats%20%3Fparties%20%3Fseats%20where%0A%7B%0A%20%20filter%28%3Fterms%20%3D%20%3Fterms_with_parties%29%0A%20%20filter%28%3Fterms%20%3D%20%3Fterms_with_seats%29%0A%20%20filter%28%3Fseats%20%3D%201%29%0A%20%20filter%28%3Fparties%20%3D%201%29%0A%20%20%7B%20select%20distinct%20%3Fmp%20%3FmpLabel%20%3Fterms%20%3Fterms_with_parties%20%3Fterms_with_seats%0A%20%20%20%20%28count%28distinct%20%3Fparty%29%20as%20%3Fparties%29%20%0A%20%20%20%20%28count%28distinct%20%3Fseatname%29%20as%20%3Fseats%29%20%0A%20%20%20%20%20%20WHERE%20%7B%0A%20%20%20%20%20%20%20%20%3Fmp%20wdt%3AP31%20wd%3AQ5%20.%20%3Fmp%20p%3AP39%20%3Fps%20.%20%3Fps%20ps%3AP39%20%3Fposition%20.%20%3Fposition%20wdt%3AP279%20wd%3AQ16707842.%0A%20%20%20%20%20%20%20%20optional%20%7B%20%3Fps%20pq%3AP4100%20%3Fparty%20%7D%20optional%20%7B%20%3Fps%20pq%3AP768%20%3Fseat%20.%20%3Fseat%20rdfs%3Alabel%20%3Fseatname%20.%20filter%28lang%28%3Fseatname%29%20%3D%20%22en%22%29%20%7D%0A%20%20%20%20%20%20%20%20%7B%20select%20%3Fmp%20%28count%28distinct%20%3Fps%29%20as%20%3Fterms%29%20where%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%20%3Fmp%20p%3AP39%20%3Fps%20.%20%3Fps%20ps%3AP39%20%3Fposition%20.%20%3Fposition%20wdt%3AP279%20wd%3AQ16707842.%20%7D%20group%20by%20%3Fmp%20%7D%0A%20%20%20%20%20%20%20%20optional%20%7B%20select%20%3Fmp%20%28count%28distinct%20%3Fps%29%20as%20%3Fterms_with_parties%29%20where%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%20%3Fmp%20p%3AP39%20%3Fps%20.%20%3Fps%20ps%3AP39%20%3Fposition%20.%20%3Fposition%20wdt%3AP279%20wd%3AQ16707842.%20%3Fps%20pq%3AP4100%20%3Fparty%20%7D%20group%20by%20%3Fmp%20%7D%0A%20%20%20%20%20%20%20%20optional%20%7B%20select%20%3Fmp%20%28count%28distinct%20%3Fps%29%20as%20%3Fterms_with_seats%29%20where%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%20%3Fmp%20p%3AP39%20%3Fps%20.%20%3Fps%20ps%3AP39%20%3Fposition%20.%20%3Fposition%20wdt%3AP279%20wd%3AQ16707842.%20%3Fps%20pq%3AP768%20%3Fseat%20%7D%20group%20by%20%3Fmp%20%7D%0A%20%20%20%20%20%20%20%20filter%20not%20exists%20%7B%20%3Fps%20ps%3AP39%20wd%3AQ77685926%20%7D%20%23%20no%20current%20MPs%0A%20%20%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%0A%20%20%7D%20group%20by%20%3Fmp%20%3FmpLabel%20%3Fterms%20%3Fterms_with_parties%20%3Fterms_with_seats%20%7D%0A%7D) so that they fit a standard pattern (one seat, one party, no current MPs) and the SPARQL does most of the heavy lifting in formatting the string. 

A shell script then uses the [everywordbot](https://github.com/aparrish/everywordbot) script to post the generated tweets on a scheduled basis.

* 0.1 - minimal one-line tweet.
* 0.2 - with Wikidata link only.
* 0.3 - with Wikipedia or Wikidata link, plus optional ODNB, Hansard, Rush links.
